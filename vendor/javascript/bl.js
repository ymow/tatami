import t from"stream";import e from"readable-stream/duplex";import i from"util";import s from"buffer";var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var f={};var n=s.Buffer;const u=t.DuplexStream||e,h=i;function BufferList(t){if(!((this||r)instanceof BufferList))return new BufferList(t);(this||r)._bufs=[];(this||r).length=0;"function"==typeof t?(this||r)._callback=t:n.isBuffer(t)?this.append(t):Array.isArray(t)&&t.forEach(function(t){n.isBuffer(t)&&this.append(t)}.bind(this||r));u.call(this||r)}h.inherits(BufferList,u);BufferList.prototype._offset=function(t){var e=0,i=0,s;for(;i<(this||r)._bufs.length;i++){s=e+(this||r)._bufs[i].length;if(t<s)return[i,t-e];e=s}};BufferList.prototype.append=function(t){(this||r)._bufs.push(n.isBuffer(t)?t:new n(t));(this||r).length+=t.length;return this||r};BufferList.prototype._write=function(t,e,i){this.append(t);i&&i()};BufferList.prototype._read=function(t){if(!(this||r).length)return this.push(null);t=Math.min(t,(this||r).length);this.push(this.slice(0,t));this.consume(t)};BufferList.prototype.end=function(t){u.prototype.end.call(this||r,t);(this||r)._callback&&this._callback(null,this.slice())};BufferList.prototype.get=function(t){return this.slice(t,t+1)[0]};BufferList.prototype.slice=function(t,e){("number"!=typeof t||t<0)&&(t=0);("number"!=typeof e||e>(this||r).length)&&(e=(this||r).length);if(t>=(this||r).length)return new n(0);if(e<=0)return new n(0);if(0===t&&e==(this||r).length)return n.concat((this||r)._bufs);var i=this._offset(t),s=e-t,f=s,u=0,h,o,l;t=i[1];if(f<=(this||r)._bufs[i[0]].length-t)return(this||r)._bufs[i[0]].slice(t,t+f);h=new n(s);for(l=i[0];l<(this||r)._bufs.length;l++){o=(this||r)._bufs[l].length-t;if(!(f>o)){(this||r)._bufs[l].copy(h,u,t,t+f);break}(this||r)._bufs[l].copy(h,u,t);u+=o;f-=o;t&&(t=0)}return h};BufferList.prototype.toString=function(t,e,i){return this.slice(e,i).toString(t)};BufferList.prototype.consume=function(t){while((this||r)._bufs.length){if(!(t>(this||r)._bufs[0].length)){(this||r)._bufs[0]=(this||r)._bufs[0].slice(t);(this||r).length-=t;break}t-=(this||r)._bufs[0].length;(this||r).length-=(this||r)._bufs[0].length;(this||r)._bufs.shift()}return this||r};(function(){var t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};Object.keys(t).forEach((function(e){BufferList.prototype[e]=function(i){return this.slice(i,i+t[e])[e](0)}}))})();f=BufferList;var o=f;export default o;

